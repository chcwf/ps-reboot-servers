#Uncomment next line if you need to installs powercli module if you don't have it 
#Install-Module -Name VMware.PowerCLI

#Sets mode to default dal-itvcenter as the only server it connects to - ignore any prompts to connect - auto accept certificate
    set-powercliconfiguration -DefaultVIServerMode single -InvalidCertificateAction ignore -scope user -Confirm:$false
#YOU MUST UNCOMMENT THE LINE BELOW TO ACTUALLY CONNECT TO VSPHERE - IT SHOULD USE YOUR CURRENT CREDENTIALS TO CONNECT    
connect-viserver â€“server mlk-vcenter.netchc.local

$virtualmachines = Get-Content 'c:\temp\virtualmachines.txt' 

#Shutdown all the VMs
        foreach ($VM in $virtualmachines)

        {

        Shutdown-VMGuest -VM $VM -Confirm:$false

        }

#Pause give them time to shut down
Start-Sleep 60

#Turn all the VMs back on
        foreach ($VM in $virtualmachines)

        {

       
        Start-VM -VM $VM -Confirm:$false

        }
